
.page-header
  .pull-right
    = link_to 'All', tasks_path(status: 'all')
    = "|"
    = link_to 'Incomplete', tasks_path(status: 'incomplete')
    = link_to 'Create Task', new_task_path, :class => 'btn btn-primary'
    - if (params[:status]) == 'incomplete'
      = link_to 'Download CSV', tasks_path(format: :csv, status: params[:status], sort: params[:sort]), class: 'btn btn-default'
    - else
      = link_to 'Download CSV', tasks_path(format: :csv, status: params[:status], sort: params[:sort]), class: 'btn btn-default'
  %h1 Listing Task

%table.table
  %tr
    %th= link_to 'Description', tasks_path(status: params[:status], sort: 'description')
    %th= link_to 'Due Date', tasks_path(status: params[:status], sort: 'due_date')
    %th= link_to 'Complete Task?', tasks_path(status: params[:status], sort: 'complete')
    %th

  - @tasks.each do |task|
    %tr{class: ("danger" if task.due_soon?)}
      %td= task.description
      - if task.due_date.nil?
        %td Infinite
      - else
        %td= task.due_date.strftime("%B %e, %Y")
      %td
        = form_for(task, html: {class: "form-horizontal"}) do |f|
          = f.check_box :complete
          = f.submit :class => 'btn btn-default btn-sm'
      %td
        .pull-right
          = link_to 'Show', task, class: 'btn btn-primary'
          = link_to 'Edit', edit_task_path(task), class: 'btn btn-success'
          = link_to 'Destroy', task, class: 'btn btn-danger', :method => :delete, :data => { :confirm => 'Are you sure?' }


= paginate @tasks
